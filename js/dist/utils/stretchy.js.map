{"version":3,"sources":["../../src/utils/stretchy.js"],"names":["self","Element","prototype","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","$$","expr","con","Node","Window","slice","call","document","querySelectorAll","_","Stretchy","selectors","base","filter","script","currentScript","pop","resize","element","resizes","cs","getComputedStyle","offset","empty","value","placeholder","type","nodeName","toLowerCase","style","height","boxSizing","offsetHeight","clientHeight","parseFloat","minHeight","scrollHeight","width","offsetWidth","clientWidth","minWidth","Math","max","scrollWidth","i","scrollLeft","length","selectedIndex","option","createElement","textContent","options","parentNode","insertBefore","nextSibling","appearance","property","test","removeChild","resizeAll","elements","forEach","active","init","getAttribute","body","readyState","addEventListener","window","listener","evt","target","documentElement","MutationObserver","mutations","mutation","addedNodes","observe","childList","subtree"],"mappings":"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","file":"stretchy.js","sourcesContent":["/*\n * Stretchy: Form element autosizing, the way it should be.\n * by Lea Verou http://lea.verou.me\n * MIT license\n */\n(function() {\n\nif (!self.Element) {\n\treturn; // super old browser\n}\n\nif (!Element.prototype.matches) {\n\tElement.prototype.matches = Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector || null;\n}\n\nif (!Element.prototype.matches) {\n\treturn;\n}\n\nfunction $$(expr, con) {\n\treturn expr instanceof Node || expr instanceof Window? [expr] :\n\t       [].slice.call(typeof expr == \"string\"? (con || document).querySelectorAll(expr) : expr || []);\n}\n\nvar _ = self.Stretchy = {\n\tselectors: {\n\t\tbase: '.stretchy',\n\t\tfilter: \"*\"\n\t},\n\n\t// Script element this was included with, if any\n\tscript: document.currentScript || $$(\"script\").pop(),\n\n\t// Autosize one element. The core of Stretchy.\n\tresize: function(element) {\n\t\tif (!_.resizes(element)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar cs = getComputedStyle(element);\n\t\tvar offset = 0;\n\t\tvar empty;\n\n\t\tif (!element.value && element.placeholder) {\n\t\t\tempty = true;\n\t\t\telement.value = element.placeholder;\n\t\t}\n\n\t\tvar type = element.nodeName.toLowerCase();\n\n\t\tif (type == \"textarea\") {\n\t\t\telement.style.height = \"0\";\n\n\t\t\tif (cs.boxSizing == \"border-box\") {\n\t\t\t\toffset = element.offsetHeight;\n\t\t\t}\n\t\t\telse if (cs.boxSizing == \"content-box\") {\n\t\t\t\toffset = -element.clientHeight + parseFloat(cs.minHeight);\n\t\t\t}\n\n\t\t\telement.style.height = element.scrollHeight + \"px\";\n\t\t}\n\t\telse if(type == \"input\") {\n\t\t\t// First test that it is actually visible, otherwise all measurements are off\n\t\t\telement.style.width = \"1000px\";\n\n\t\t\tif (element.offsetWidth) {\n\t\t\t\telement.style.width = \"0\";\n\n\t\t\t\tif (cs.boxSizing == \"border-box\") {\n\t\t\t\t\toffset = element.offsetWidth;\n\t\t\t\t}\n\t\t\t\telse if (cs.boxSizing == \"padding-box\") {\n\t\t\t\t\toffset = element.clientWidth;\n\t\t\t\t}\n\t\t\t\telse if (cs.boxSizing == \"content-box\") {\n\t\t\t\t\toffset = parseFloat(cs.minWidth);\n\t\t\t\t}\n\n\t\t\t\tvar width = Math.max(offset, element.scrollWidth - element.clientWidth);\n\n\t\t\t\telement.style.width = width + \"px\";\n\n\t\t\t\t// To bulletproof, we will set scrollLeft to a\n\t\t\t\t// huge number, and read that back to see what it was clipped to\n\t\t\t\t// and increment width by that much, iteratively\n\n\t\t\t\tfor (var i=0; i<10; i++) { // max iterations\n\t\t\t\t\telement.scrollLeft = 1e+10;\n\n\t\t\t\t\tif (element.scrollLeft == 0) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\twidth += element.scrollLeft;\n\n\t\t\t\t\telement.style.width = width + \"px\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Element is invisible, just set to something reasonable\n\t\t\t\telement.style.width = element.value.length + 1 + \"ch\";\n\t\t\t}\n\t\t}\n\t\telse if (type == \"select\") {\n\t\t\tvar selectedIndex = element.selectedIndex > 0? element.selectedIndex : 0;\n\n\t\t\t// Need to use dummy element to measure :(\n\t\t\tvar option = document.createElement(\"_\");\n\t\t\toption.textContent = element.options[selectedIndex].textContent;\n\t\t\telement.parentNode.insertBefore(option, element.nextSibling);\n\n\t\t\t// The name of the appearance property, as it might be prefixed\n\t\t\tvar appearance;\n\n\t\t\tfor (var property in cs) {\n\t\t\t\tvar value = cs[property];\n\t\t\t\tif (!/^(width|webkitLogicalWidth|length)$/.test(property) && typeof value == \"string\") {\n\t\t\t\t\t//console.log(property, option.offsetWidth, cs[property]);\n\t\t\t\t\toption.style[property] = value;\n\n\t\t\t\t\tif (/appearance$/i.test(property)) {\n\t\t\t\t\t\tappearance = property;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toption.style.width = \"\";\n\n\t\t\tif (option.offsetWidth > 0) {\n\t\t\t\telement.style.width = option.offsetWidth + \"px\";\n\n\t\t\t\tif (!cs[appearance] || cs[appearance] !== \"none\") {\n\t\t\t\t\t// Account for arrow\n\t\t\t\t\telement.style.width = \"calc(\" + element.style.width + \" + 2em)\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toption.parentNode.removeChild(option);\n\t\t\toption = null;\n\t\t}\n\n\t\tif (empty) {\n\t\t\telement.value = \"\";\n\t\t}\n\t},\n\n\t// Autosize multiple elements\n\tresizeAll: function(elements) {\n\t\t$$(elements || _.selectors.base).forEach(function (element) {\n\t\t\t_.resize(element);\n\t\t});\n\t},\n\n\tactive: true,\n\n\t// Will stretchy do anything for this element?\n\tresizes: function(element) {\n\t\treturn element &&\n\t\t       element.parentNode &&\n\t\t       element.matches &&\n\t\t       element.matches(_.selectors.base) &&\n\t\t       element.matches(_.selectors.filter);\n\t},\n\n\tinit: function(){\n\t\t_.selectors.filter = _.script.getAttribute(\"data-filter\") ||\n\t\t                     ($$(\"[data-stretchy-filter]\").pop() || document.body).getAttribute(\"data-stretchy-filter\") || Stretchy.selectors.filter || \"*\";\n\n\t\t_.resizeAll();\n\t},\n\n\t$$: $$\n};\n\n// Autosize all elements once the DOM is loaded\n\n// DOM already loaded?\nif (document.readyState !== \"loading\") {\n\t_.init();\n}\nelse {\n\t// Wait for it\n\tdocument.addEventListener(\"DOMContentLoaded\", _.init);\n}\n\nwindow.addEventListener(\"load\", function(){\n\t_.resizeAll();\n});\n\n// Listen for changes\nvar listener = function(evt) {\n\tif (_.active) {\n\t\t_.resize(evt.target);\n\t}\n};\n\ndocument.documentElement.addEventListener(\"input\", listener);\n\n// Firefox fires a change event instead of an input event\ndocument.documentElement.addEventListener(\"change\", listener);\n\n// Listen for new elements\nif (self.MutationObserver) {\n\t(new MutationObserver(function(mutations) {\n\t\tif (_.active) {\n\t\t\tmutations.forEach(function(mutation) {\n\t\t\t\tif (mutation.type == \"childList\") {\n\t\t\t\t\tStretchy.resizeAll(mutation.addedNodes);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t})).observe(document.documentElement, {\n\t\tchildList: true,\n\t\tsubtree: true\n\t});\n}\n\n})();\n"]}